基于深度学习的低功耗毫米波雷达心跳信号的重构

#### 批注

#### 名词
##### 低功耗雷达
- 一种雷达技术，其设计旨在在工作过程中使用较少的电力。传统雷达系统通常需要大量的电力以运行，这对于移动或便携应用，尤其是在电力有限的环境下，可能是不切实际的。低功耗雷达通常采用一系列技术和设计策略，以减少功耗，同时仍能提供足够的性能来满足特定的应用需求
- iwr1843boost和iwr1443都是低功耗的雷达

##### 天线封装雷达Aip
- 线和雷达传感器的其他组件被封装在一个整体的封装中。这种集成设计的目的是提供更紧凑、集成和方便安装的雷达系统，通常用于无人车辆、智能交通系统、工业自动化和其他应用中。
以下是一些可能与天线封装雷达相关的特性和考虑因素：
1. **紧凑设计：** 天线封装雷达通常旨在实现紧凑的设计，以便更容易集成到各种应用中，包括车辆、设备或基础设施。   
2. **多功能天线设计：** 天线在雷达系统中是至关重要的组件，其设计可以影响系统的性能。封装雷达通常采用特殊设计的多功能天线，以支持不同类型的雷达操作，如距离测量、速度测量和角度测量。  
3. **材料选择：** 封装雷达的外壳通常需要使用耐候、防水、防尘等特殊材料，以适应不同的环境条件。  
4. **功耗和热管理：** 封装雷达系统还需要考虑功耗和热管理，确保在长时间运行时能够有效地散热，同时保持低功耗。  
5. **集成信号处理和电子学：** 除了天线，雷达系统中的信号处理和电子学组件也可能被集成到封装中，以减小整体体积并提高系统的可靠性。   
6. **安装灵活性：** 封装雷达通常被设计为易于安装和集成，以适应不同应用的需求。
##### 信噪比SNR
- Signal-to-Noise Ratio）的缩写。信噪比是用来衡量信号与噪声之间相强度的比率。在通信、雷达、音频处理和图像处理等领域中，信噪比是一个重要的性能指标，它描述了有用信号与环境中的噪声水平之间的关系。
- ***SNR=噪声功率/信号功率​
- 这里，信号功率是指有用信号的功率，噪声功率是指噪声的功率。通常，信噪比以分贝（dB）为单位表示，计算公式如下：SNR(dB)=10⋅log⁡10(信号功率噪声功率)SNR(dB)=10⋅log10​(噪声功率信号功率​)
- ***信噪比越大情况越好

##### RR Signal
1. **R-R间隔（RR Interval）**： 在医学和生理学领域，"RR信号" 通常指的是心电图（ECG）中R波到R波之间的时间间隔，称为R-R间隔。R-R间隔是心脏一个完整心动周期的持续时间，通常以毫秒为单位。这个间隔可以用来分析心率、心律和其他心脏功能。
2. **雷达回波信号（Radar Return Signal）：** 在雷达和无线通信领域，"RR信号" 也可能指代雷达系统中由目标反射而回到雷达接收器的信号，称为雷达回波信号。***这个信号包含了目标的信息，通过分析回波信号可以确定目标的位置、速度和其他特征。

##### 快速傅里叶变换
- 快速傅里叶变换（Fast Fourier Transform，FFT）是一种计算傅里叶变换的算法，用于将一个信号从时域转换为频域。傅里叶变换是一种将信号分解成不同频率成分的数学工具，常用于信号处理、图像处理、通信等领域。FFT相比直接使用傅里叶变换的优势在于它具有更高的计算效率。传统的傅里叶变换算法的计算复杂度为O(N^2)，而FFT的计算复杂度为O(N log N)，其中N是信号的长度。这种高效的算法使得在计算机中实现傅里叶变换变得更加快速和可行。FFT算法的基本思想是利用信号的对称性和周期性，通过递归地将信号分解为较小的子问题来减少计算量。FFT广泛应用于数字信号处理、图像处理、音频处理等领域，是许多实时系统和应用中的关键算法。
- 著名和最广泛使用的是Cooley-Tukey算法。这个算法的基本思想是通过递归将一个大的傅里叶变换问题分解为许多小的傅里叶变换问题。
- Cooley-Tukey算法的主要步骤如下：
1. **分解（Decimation in Time，DIT）：** 将长度为N的信号分解为两个长度为N/2的信号。这一步可以递归地应用于每个子问题。 
2. **计算：** 对每个较小的子问题计算傅里叶变换。当子问题的长度为2时，可以通过简单的蝶形运算（Butterfly Operation）来计算。
3. **合并：** 将计算得到的傅里叶变换结果合并成原始问题的解。
这个算法的关键在于将傅里叶变换问题分解为规模更小的子问题，通过递归的方式处理这些子问题，并最终将结果合并得到整体的傅里叶变换。
Cooley-Tukey算法的时间复杂度为O(N log N)，相较于直接计算的傅里叶变换的时间复杂度O(N^2)来说，在N较大时具有明显的计算优势。这使得FFT成为处理大规模信号的标准方法，特别是在数字信号处理、通信和图像处理等领域。


##### Transmitting Power(dBm)
- 传输功率（Transmitting Power）通常用单位分贝毫瓦（dBm）来表示。这是一种用于衡量无线电频率或无线通信设备发送信号强度的标准单位。dBm是以毫瓦为基准的对数单位，计算方式如下：
-  ![[Pasted image 20231120151252.png]]

- 其中，P 是实际功率。
- 在通信领域，传输功率是指无线设备发送信号的强度，它对于确保信号在一定范围内可靠地传输至关重要。****较高的传输功率通常意味着信号可以覆盖更远的距离或穿透更多的障碍物，但同时也可能导致更高的能耗和干扰。
- 
##### VMD
- VMD" 代表的是 "Variational Mode Decomposition"，即变分模态分解。这是一种信号处理方法，用于将信号分解成多个本征模态函数（EMD）或固有模态函数（IMF），每个模态函数对应于信号中的一个频率成分。
- VMD是一种自适应的分解方法，它通过优化一个变分问题来获得信号的本征模态函数。这个优化问题的目标是找到一组模态函数，使得它们的能量彼此分离并且各自集中在不同的频率带内。通过调整优化问题的参数，VMD可以适应不同信号的特性。
- 1. **构建优化问题：** 定义一个变分问题，目标是最小化信号与模态函数之间的残差。  
2. **使用优化算法：** 使用数值优化算法，如梯度下降或其他迭代方法，来找到最小化变分问题的解。
3. **获取模态函数：** 从优化问题的解中提取模态函数，这些模态函数代表信号的不同频率成分
#### 1 摘要
##### 1.1
- 研究表明毫米波雷达可以用做心率(HR)和呼吸频率(RR)的生命体征的日常检查
- *低功耗雷达和天线封装雷达aip*越来越流行，缺点就是发射功率低，会导致雷达信号的*信噪比(SNR)下降.
- ***提出了一种用于低功耗利雷达心跳信号重建的一种方法，改方法可以利用神经网络识别信号的模式，显著的提高了心跳信号的信噪比。
- 结论:实验证明了信号重构在时域和频域都能有效地改善心跳信号。将该方法与不同人力资源分布、传感范围和主题的相关工作进行比较，结果表明该方法的准确性显著提高。为了进一步评估该方法的鲁棒性，进行了扩展连续监测，*准确率达到97.5%。


#### 2 介绍 INTRODUCTION
##### 2.1 背景(优点和缺点)
- *背景*  COVID-19大流行，使用新技术在自己家中监测健康变得很有价值。特别是生命体征心率(HR)和呼吸频率(RR)对家庭医疗至关重要，引起了人们的极大关注。可靠、准确的HR/RR监测是诊断心血管疾病、评估睡眠质量等的有用工具。除此之外，持续监测甚至可以根据长期HR/RR的变化，促进早期发现功能下降和健康恶化。
- *缺点1* 对于HR监测，心电图(ECG)和光容积脉搏波仪(PPG)设备作为接触式监测设备，仍然是临床表征心脏活动的金标准。这两种方法都需要将几个自粘电极或传感器连接到人体皮肤上，以获得高质量的心跳信号[1]。然而，它们不方便，会引起不适，这限制了它们的长期使用。此外，它们不适合皮肤过敏和痴呆的个体，并且患者对被监测的意识会影响测量的准确性。
- *优点1* 非接触式传感器技术可以在没有电极和触摸的情况下从远处估计HR，使其使用更简单，更舒适。一般来说，它提供了一种低成本、高时间分辨率的方法，可以随时随地监测健康状况，而无需任何操作。它可以在日常生活中对HR进行持续、长期的自我监控。因此，来自任何地区的患者都可以与医生联系，无需亲自访问即可获得临床试验数据。
- ***雷达估计心率/心率的基本方法是测量天线与胸部之间的微运动。
- *优点2* 毫米波雷达不依赖于视觉数据。雷达传感器基于射频(RF)信号，因此不受照明条件和衣服不透明度的影响。不产生图像视频信号，因此不存在私人住宅使用的隐私问题。因此，雷达非常适合用于家庭人力资源监测。
- 由于家庭的复杂性很难对BR造成一定精确程度的估计。
##### 2.2 研究中的问题
- 由于随着距离的增加会产生额外的衰减，降低信号信噪比，因此这些研究的监测距离一般较短(0.5 m以内)，难以保证准确的HR监测能力。
- 一系列的人员进行操作发现并没有进行一个好的方法于是作者提出了他的方法
- ***低功率毫米波雷达的低信噪比使得在实际使用中难以获得可靠的HR估计，成为阻碍毫米波HR监测雷达设备在国内广泛应用的主要障碍。
- ***以前的工作主要集中在信号的频率和幅度特征上，即从噪声信号中提取目标人的心跳信号。然而，在低信噪比条件下，这些方法受到噪声的影响，由于振幅太大就是频率很接近心跳的信号，所以很难获得他的精度。
- 然而，由于心跳引起的胸壁运动是由心脏血流过程产生的。因此，动作要有固定的模式。通过保持身体不动并屏住呼吸，我们在雷达获得的胸壁运动信号中观察到具有特定模式的明显心跳信号，如图1所示。
- 受到计算机视觉领域最近一些优秀研究的启发，我们考虑使用深度神经网络来更好地检测这种特定模式，因为它们已经在许多领域的复杂分类、检测任务中得到了验证
- ![[Pasted image 20231120145951.png]]
- 为了从低信噪比雷达信号中恢复可靠的HR参数，***提出了一种基于dl的小功率的毫米波雷达HR估计的方法

##### 2.3 其他方法与这个方法的区别
- 其他研究人员的方法
- 毫米波雷达研究人员现状![[Pasted image 20231120150618.png]]
- 相关的工作，以及论文，使用的什么设备去提取的信号，以及方法，和最终的结果,传输的功率，以及range(m) 范围多少米
- ***当前所使用的方法方法将心跳解释为脉冲信号。在胸壁运动流上使用滑动窗口，将窗口帧馈送到集中心跳脉冲的神经检测器。以检测到的心跳频率作为HR当量，通过信号模式检测实现信号重构过程。VMD算法利用不同的中心频率分量来更好地评估当前帧是否与心跳相对应。它将一维时间序列转换成二维矩阵。最后，利用历史数据进行高精度的频率估计

##### 2.4 方法的优点
- 基于深度神经网络的探测器成功地在低信噪比雷达数据中高精度地检测到心跳。将检测结果的时间序列作为重构的心跳信号进行连续心率监测。
- 引入VMD算法，提供信号不同频率分量的信息，为检测网络提供更丰富的输入特征，提高网络的监测效率。
- 从时域和频域分析了利用深度神经网络检测器重构心跳信号的有效性。将该方法与其他非神经网络方法进行了比较，突出了该方法在实际场景监测中的优势。
- 基于HeRe的低功率毫米波雷达HR监控系统概述。

#### 3 methods 方法
##### 3.1 方法的流程图以及综述
![[Pasted image 20231120162745.png]]
###### 3.1.1 body reflection 
###### 3.1.2 Data preprocession 数据准备 
- Raw singal acquisition原始信号采集
- target detection -> phase unwarap
1. **目标检测：** 在雷达或光学成像系统中，目标通常通过发射的信号与目标反射的信号之间的相位差异来检测。这样的相位信息可能在一定范围内变化，但在处理过程中可能会出现 "wrapped"（包裹）的现象，即相位值在某个范围内循环。  
2. **相位展开：** 相位展开的目的是将相位的循环效应消除，以便更准确地表示相位信息。这通常涉及到将相位值从 [-π, π] 或 [0, 2π] 等范围中展开到更大的范围。这可以通过检测相位的跳跃点，并在展开时修正这些跳跃点来实现。   
3. **进一步的目标分析：** 展开后的相位信息更容易用于进一步的目标分析、跟踪或测量。例如，在合成孔径雷达（SAR）中，相位展开后的数据可用于生成高分辨率的图像。

***数据预处理:从原始接收信号中得到中频信号(IF信号)和距离-多普勒矩阵。然后，识别目标人体对应的距离，提取目标距离库处的微运动信号作为输入信号进行后续重构***
###### 3.1.3 Heartbeat signal reconstruction
- Chest wall 胸壁抖动的信号
- Feature matrix（特征矩阵）
- Feature decomposition（特征分解）是指将数据的特征进行拆解或分解的过程。这可以涉及到从原始特征中提取更有信息量的特征，或者将高维数据表示为更低维的形式，以便更好地理解和处理数据。
- Pattern detector（模式检测器）是指一种系统、算法或设备，专门设计用于检测数据中的模式或规律。这种技术在多个领域中都有应用，包括信号处理、图像处理、数据挖掘、机器学习等。

 ***心跳信号重构:将提取的一维微运动信号通过VMD算法分解为二维特征矩阵，滑动窗口对特征矩阵进行移动和采样，生成数据集。数据集被传递到检测器网络，以识别心跳信号的存在***
###### 3.1.4 HR estimation
![[Pasted image 20231120163356.png]]


- Frequency domain analysis 是一种用于分析信号在频域中性质的方法。这种分析涉及到使用傅里叶变换或其他频谱分析工具，将信号从时域（time domain）转换到频域（frequency domain）。在频域中，我们可以观察信号中不同频率的成分，以及它们在信号中的相对强度。
- 以下是进行 Frequency domain analysis 的一些步骤和关键概念：
  1. **傅里叶变换（Fourier Transform）：** 主要工具是傅里叶变换，它将时域中的信号分解为一组不同频率的正弦和余弦成分。傅里叶变换有连续和离散两种形式，分别适用于连续信号和离散信号。   
  2. **频谱（Spectrum）：** 频谱表示信号在频域中的特征，显示了信号中不同频率的成分及其强度。频谱可以是幅度谱（表示振幅）或相位谱（表示相位）。 
  3. **功率谱密度（Power Spectral Density, PSD）：** PSD 描述了信号在频域中的能量分布，是频谱的平方。它对于分析信号的能量集中在哪些频率上很有帮助。
  4. **频域滤波：** 在频域中进行滤波操作，可以通过去除或强调特定频率范围内的成分来修改信号。
  5. **频域特征提取：** 从频域中提取有关信号性质的信息，如频率、振幅、相位等。
  6. 此种主要使用的是快速傅里叶变换。
- Final estimation based on history 意味着通过历史数据进行最终估计或预测
***HR估计:在执行检测器网络后，获得高精度HR值的挑战仍然存在。采用带历史数据校正的频域分析方法获得了高精度的HR估计***

##### 3.2 数据预处理 Data Preprocessing




#### 4 数据预处理
##### 4.1 



#### 5 心跳信号重建
##### 5.1 过去的方法
- 研究人员通常将呼吸和心跳等同于典型的正弦信号，像信号
- 每次心跳时间都有一个清晰可识别的信号模式，它与周期脉冲信号的相似性更强(如图1所示)。我们建议通过对其波形模式的分析，将心跳信号作为脉冲信号来处理，而不是传统的周期正弦信号。我们的方法利用接收到的雷达信号上的滑动窗口，将信号重构问题转化为信号模式检测问题。窗口帧被连续地输入到神经检测器中，该检测器将这些帧标记为“心跳”或“非心跳”。重点是心跳的频率特性，因为目标是获得HR。检测过程的结果序列与原始心跳信号具有相同的周期性和频谱分布，并且由于深度神经网络的力量，能够消除与心跳无关的噪声或失真。因此，信号模式检测结果序列作为重构的心跳信号，可用于进一步估计心率
- 在特征提取部分，为了挖掘雷达信号中可以被充分利用的不同频率成分，首先使用VMD方法将原始信号分解为独立的频率成分。
- VMD算法是一种完全非递归的VMD方法，模态提取是并行的。恢复的VMD模态称为内禀模态分量(IMF)，实现了信号从低频到高频的有效分离
- ![[Pasted image 20231207152041.png]]

式中，k为待恢复的IMF个数，uk为第k个IMF， ωk为第k个中心频率，x f (t)为原胸壁位移的镜像对称延伸。

然后利用二次罚函数和拉格朗日乘子求解构造的变分方程:
![[Pasted image 20231207153507.png]]

其中α表示数据保真度约束的平衡参数，可以清楚地识别为电流残差的维纳滤波，信号先验为1/(ω−ωk) 2。乘法器的交替方向法(ADMM)[40]使用以下公式获得第n个周期的所有imf:
![[Pasted image 20231207153546.png]]


### 汇报

#### 0 实验准备 
  硬件实现：提出的HeRe系统在一款用于实验测试的消费级低功耗雷达平台上构建，该平台采用了英飞凌技术公司（Infineon Technologies AG）的BGT60TR13C雷达芯片组 [46]。这是一款采用AiP技术（Antenna in Package）的功耗优化型FMCW雷达，具有紧凑的体积。如图9所示，雷达芯片组与一元人民币硬币相比。该雷达的发射功率（TX power）仅为5 dBm，比[11]中使用的发射功率低12.5倍，比[23]中使用的低10倍，比[10]、[22]、[24]和[25]中使用的低5倍。雷达的载波频率（fc）为60 GHz，并配置为在频率范围从fmin = 60 GHz到fmax = 61 GHz内发送啁啾。因此，覆盖了1 GHz的频带宽度B，导致距离分辨率δr为15厘米。此外，雷达可以发送啁啾的突发，称为数据帧。然而，为了最小化功耗和计算消耗，我们使用由单个啁啾组成的数据帧，帧重复时间为33.3毫秒，即频率为30赫兹，这足以进行生命体征监测。表III显示了整个实验中使用的BGT60TR13C雷达的主要配置参数。
  

  在实验过程中，被试保持静止并自然呼吸。如图10所示，他们需要佩戴一个戴在耳朵上的接触式PPG传感器以获得参考值。三名被试参与了数据收集实验，他们年龄在20到30岁之间，且没有心脏病。为了评估模型的泛化能力，只有一个被试提供了训练数据集，而来自其他被试的数据用于构建验证集。具体而言，我们收集了450分钟（7.5小时）的监测数据作为训练数据集，这些数据是在固定距离0.6米处获得的。为了从多个角度评估提出的方法，我们进一步获得了1005分钟（16.75小时）的监测数据作为验证数据集，这些数据分为四个类别：不同心率分布的数据集（45-90 BPM），在不同距离（0.3-2.4米）获得的数据集，来自不同被试的数据集（三人），以及长时间监测的数据集（240分钟）。所收集的数据集及相关参数列于表IV中。
#### 1 Methods 方法
##### 1 
- 图显示了HeRe的方案。提出的HeRe方法包括三个步骤
![[Pasted image 20231209145840.png]]

1）数据预处理：从原始接收信号中获得中频信号（IF信号）和距离–多普勒矩阵。然后，识别与目标人体相对应的距离，并提取目标距离箱中的微运动信号作为输入信号，用于接下来的重建过程。
2）心跳信号重建：提取的1-D微运动信号通过VMD算法分解为2-D特征矩阵，滑动窗口移动并对特征矩阵进行采样以创建数据集。数据集传递给检测器网络以识别心跳信号的存在。
3）心率估计：在执行了检测器网络之后，获得高准确性心率值的挑战仍然存在。通过频域分析和历史数据校正来获得高准确性的心率估计。

##### 2 数据预处理
- 该项目中使用的雷达是调频连续波（FMCW）雷达，这意味着发射波形的频率从起始频率fmin线性地扫描到结束频率fmax，扫描持续时间为Tr（也称为快时间）。扫描带宽B = fmax − fmin = K Tr，其中K是Tx信号频率的斜率。
- 与典型的多普勒雷达不同，FMCW雷达不仅提供目标的多普勒信息（速度信息），还同时提供目标的距离信息。它们可以区分不同范围内的杂波并提取目标的微运动信息，使其成为室内生命体征检测领域的主流选择。
- 如图3所示，发射波通过波形发生器生成并通过电压控制振荡器（VCO）调制。然后，经过功率放大器（PA）放大的发射信号通过Tx天线发送到外部环境。在监测范围内被目标反射后，波被Tx天线接收并通过低噪声放大器（LNA）传递，以获得与发射信号相同频率的信号。FMCW雷达系统通过中频信号sif(t)（即发射和接收信号之间的差异）测量距离和速度。
- ![[Pasted image 20231209150528.png]]
- 复杂的传送信号为
-![[Pasted image 20231209152530.png]]
- s(t) 是信号的复数表示，包含相位和振幅信息。
- At​ 是信号的振幅，表示信号的强度。
- j 是虚数单位。
- 2πfmin​t 表示信号的频率成分，其中 fmin​ 是信号的起始频率。
- 2πKt2 表示信号的频率斜率成分，其中 K 是频率斜率t 是时间。
- ![[Pasted image 20231209152640.png]]

这种类型的信号是在发射过程中以线性方式改变频率，允许雷达同时获取目标的距离和速度信息。

- 接收信号
-   
接收到的信号是信号s(t) 的延迟版本，延迟时间为td = 2d(t)/c，其中 c 表示光速，td​ 表示相对于雷达的目标胸壁的距离。d(t) 由以下三个组件构
![[Pasted image 20231209152912.png]]
- d(t) 是目标的距离，是 d0​（初始距离）、dR​（由呼吸引起的位移）和 dH​（由心脏跳动引起的位移）三个部分的和。
- d0​ 是目标相对于雷达的初始距离。
- x(t) 表示目标相对于 �0d0​ 的位移。
- dR​ 是由呼吸引起的位移。
- dH​ 是由心脏跳动引起的位移。
- d0​ 是相对于雷达的人类胸壁的平均距离，当人体保持稳定时，可以视为常数。
- x(t)=dR​+dH​ 是由呼吸和心跳引起的胸壁的微小运动。
-
***因此，接收信号（RX signal）和发射信号（TX signal）经过混频器（mixer）处理，得到中频信号（IF signal） sif(t)。中频信号的表达式如下***
![[Pasted image 20231209153855.png]]




![[Pasted image 20231209154357.png]]

如图4所示，我们将 IF 信号 sif​(t) 组成一个矩阵，然后进行FFT以获得范围-慢时间矩阵 M(r,a,t)（也称为范围-多普勒矩阵），其中 r、a 和 t 分别表示范围、幅度和慢时间。因此，可以通过从与目标范围对应的范围FFT频率点中提取相位来获得心跳和呼吸的幅度信息。

即使这样获得的信息依然不是很准
所以

***此外，为了获取目标的准确距离，需要消除静态杂波的干扰。回波信号包含来自环境中地板、墙壁和其他静态物体反射的静态杂波。这些背景噪声可能导致极大的反射分量，从而偏离距离的判断。本文采用传统雷达技术中的一种通用方法，称为运动目标指示器（MTI***该方法将范围-慢时间矩阵中每个像素的时间平均强度视为背景噪声。然后，可以从范围-慢时间矩阵 M(r,a,t) 中减去来自杂波的回波信号。也就是下面的表达式。
![[Pasted image 20231209154946.png]]
![[Pasted image 20231209155007.png]]
这里，M(r,a,t)MTI​ 表示去噪的范围-慢时间矩阵，α 是一个加权的一个参数。


通过上述信号预处理获得胸壁微运动相位序列，将传递到以下的重建过程。

##### 3 信号重建
- 在过去的研究中，研究人员通常将呼吸和心跳都视为类似于典型正弦波形的信号，仅在周期性和振幅上有所不同。然而，实际上，每次心跳都有一个明显可识别的信号模式，更类似于周期脉冲信号（如图1所示）。基于波形模式的分析，我们提议将心跳信号视为脉冲信号，而不是传统的周期性正弦信号。我们的方法通过对接收到的雷达信号进行滑动窗口处理，将信号重建问题转化为信号模式检测问题。窗口帧连续输入神经检测器，该检测器将帧标记为“心跳”或“非心跳”。重点是心跳的频率特性，因为目标是获得心率。检测过程的结果序列具有与原始心跳信号相同的周期性和频谱分布，并且能够消除与心跳无关的噪声或失真，这要归功于深度神经网络的强大能力。因此，信号模式检测的结果序列作为重建的心跳信号，并可用于进一步估计心率。
- 在特征提取部分，为了充分利用雷达信号的不同频率成分，使用了VMD方法首先对原始信号进行分解，得到独立的频率成分。
- VMD（Variate Mode Decomposition）方法是一种信号分解方法，用于将信号分解为多个固有模态函数（Intrinsic Mode Functions，IMF）。它允许信号的不同频率成分以自适应的方式分离出来，使得每个IMF代表信号的一个频率成分。这种方法可以用于分析信号中的不同振动模式，对于非平稳和非线性信号的分析特别有用。在上下文中，VMD被用于提取雷达信号中的微动信息，以便更准确地估计心跳率

 1 首先，构建一个变分问题，假设每个模态是具有中心频率的有限带宽
 ![[Pasted image 20231209161153.png]]
 2 接下来使用二次惩罚函数和拉格朗日乘数法来求解以下构造的变分方程：
![[Pasted image 20231209161305.png]]
这里的 α 是数据适应性约束的平衡参数，被清楚地识别为当前残差的Wiener滤波器，其中信号先验为 1/(ω−ωk​)²。

![[Pasted image 20231209161850.png]]

![[Pasted image 20231209161932.png]]

![[Pasted image 20231209162216.png]]


  
在检测部分，我们构建了一个检测器网络（二元分类），而用于训练的参考值是通过时间对齐的接触测量设备（PPG）获取的。工作流程如图7所示。滑动窗口的长度由先验知识确定，用于心跳信号的周期性，在本文中设置为72帧，对应于约2秒的时间长度，以在输入特征丰富性和检测延迟之间取得平衡。较长的窗口长度有助于网络综合更多信息，从而做出更准确的判断。然而，窗口太长会导致更大的延迟和更低的事件时间准确性。然后，一个滑动窗口中的雷达数据可以被构造成矩阵Xt，其形状为7 × 72。参考标签yt的确定不仅仅取决于窗口中是否存在心跳，而更取决于窗口中心t与心跳中心tPPG i 的接近程度。在这里，t PPG i 是从PPG流数据中的第i个脉冲信号中提取的，其超过了一个阈值。如果存在tPPG i 满足 ∥t − tPPG i ∥ < τ，yt 被设置为True；否则，yt 被设置为False。τ表示预期的心跳持续时间和时间对齐精度，设置为8帧（0.25秒）。


图8![[Pasted image 20231209162547.png]]
神经网络![[Pasted image 20231209162630.png]]

我们的检测器模型的骨干是一个轻量级的神经网络。与常规的图像分类任务相反，来自雷达的输入数据的维度相对较小。因此，我们基于ResNet 构建了一个轻量级网络，如图8所示。详细的模型结构在表II中描述。网络的输出是一个标量，表示当前窗口时间是心跳瞬间的概率 ˆ yt = f W(Xt ) ∈ R1。W表示模型参数（即神经网络中的权重和偏置）。通常，通过最小化输出概率和来自接触式心跳传感器的参考标签之间的二元交叉熵（BCE）损失来训练最佳参数 y loss(X) = −w[ˆ y · log y + (1 − ˆ y ) · log(1 − y)]。(11)我们使用Adam优化器 [42]通过最大化(11)中的损失(X)来更新网络的参数。，


##### 4 心跳估计

在连续长时间监测过程中实现高度精确的频率估计仍然是一个具有挑战性的任务。这是因为在监测过程中可能会发生突然而显著的噪声干扰，比如咳嗽或大幅度的随机身体摇晃。为了解决这个问题，我们提出通过将该过程分为两部分来估计心率：基于频域分析和基于历史数据的校正。
在半静态条件下，人体的心率不应该发生突然而剧烈的变化，而是应该呈现出平稳而渐变的变化。因此，在长期监测的情境下，我们可以利用同一受试者最近过去的历史监测信息来确定当前监测结果的可靠性。在考虑噪声信号分布的随机性的同时，大多数情况下，与噪声相关的谱峰在两个连续的时间窗口中是不连续的，而与心率相关的谱峰在连续的几个时间窗口中位置保持不变。

于是与一些最近的研究类似，我们建立了一种基于历史信息的心率跟踪方法。谱峰跟踪包括初始化、峰值选择和验证。


在初始化阶段，要求受试者尽量减少身体运动。由于没有先前的信息来帮助找到正确的心率，因此在此阶段，可以通过选择在重构信号频谱中最高的三个谱峰中的最高峰来估算心率。 2) 峰值选择: 在当前时间窗口中选择不多于三个幅度最大的候选频率，其中幅度应不低于阈值 η。在我们的实验中，阈值 η 被设定为最大幅度的 85%。用 F_i (i = 1, 2, 3) 按相关幅度的降序表示候选频率。 3) 验证: 第一个原则是防止在两个连续的时间窗口中估算的心率值发生大变化。由于在非强化活动期间，人类的心率不会剧烈波动，因此在 1 分钟内心率值的变化很少超过 25 次/分钟 。因此，那些偏离上一次估计值太远的候选频率应被视为突发噪声并被滤除。

第二个原则是防止长时间内丢失跟踪。如果强烈的噪声干扰在长时间内持续存在，那么在许多连续的时间窗口中可能会发生相同的心率选择。因此，与心率相关的频谱峰可能会丢失，可能无法找回。为了避免这种情况，如果先前的心率在连续的h个时间窗口中重复出现，则有 Fest = Fprev + Dtrend · θ（14），其中 Dtrend ∈ {−1, 1} 表示心率峰值位置的变化方向。在实验中，我们设置 h = 3，并计算 Dtrend 如下：Dtrend = { 1，如果 ∀Fi 使得 Fi − Fprev > θ −1，如果 ∀Fi 使得 Fi − Fprev < −θ。
####  D Estimation Performance of HR Tracking 
##### 2 成功率Ps
![[Pasted image 20231209103210.png]]

![[Pasted image 20231209103238.png]]

- 在这个公式中，N 代表总估计数量，而 △F 被设置为 4 BPM，用于心跳监测实验中，表示允许的测量误差。因此，如果通过雷达估计的心率与参考心率的差值在4 BPM以内，就被认为是成功的估计。这个值 △1F 通常用于定义一个容忍范围，即在此范围内的差异被认为是可以接受的。

-总结 
成功率 Ps​ 越高，表明心率估计误差在可接受范围内的可能性越大。这个指标评估了通过该方法获得的心率的可接受性。在心率监测中，高成功率通常表示该方法对于准确估计心率是更为可靠的。因此，通过比较不同方法的成功率，可以评估它们在心率估计方面的相对性能。

##### 3 平均相对误差

![[Pasted image 20231209110905.png]]


##### 4 均分相对误差
![[Pasted image 20231209111057.png]]


##### 5 验证
###### 5.1 Performance 1 (Various HR Distributions):
- 不同心率的分析
- 对于同一人来说，健康状况会影响个体平均静息心率的分布。从随时间变化的平均静息心率的变化中确定健康状况的变化非常重要。为了测试我们提出的HeRe在不同分布下监测心率的能力，选择了四个验证数据集。每个对应的连续监测距离为0.6米，监测时间为1小时：45 BPM（入睡前的低心率状态），60 BPM（休息状态），80 BPM（日常状态）和90 BPM（兴奋状态）。对于每个心跳率估计结果，取1分钟的数据长度.
![[Pasted image 20231209112232.png]]

  (a)–(d)显示了HeRe与上述三种其他方法在上述四种不同心率水平情况下的心跳监测结果的比较。每个图中显示了在单个实验中的连续心跳监测结果，红色虚线表示我们方法预测的心跳结果，黑色波形表示由PPG传感器获得的参考心跳结果。受试者的心率在44到110 BPM的范围内波动，而本文提出的方法得出的预测完全能够跟上参考值的变化。而其他的方法误差就比较大了。
  

![[Pasted image 20231209113706.png]]

- 表V显示了所提出的方法与其他心率监测方法的比较结果。DE方法获得的准确度略高于FFT滤波和小波方法。然而，所有比较的方法几乎都无法提供可靠的心率估计，这是由于信噪比和呼吸谐波的干扰。然而，本文提出的HeRe方法能够成功抵消低发射功率雷达对心率跟踪的影响，从而实现准确的估计和较小的误差。


###### 5.2  不同的范围
- 另一个众所周知的事实是，感知范围会影响估计的准确性，因为雷达方程被注释为
![[Pasted image 20231209114053.png]]
- Pr 是接收功率。
- Pt 是发送功率。
- Gt 是发射天线增益。
- Gr 是接收天线增益。
- σ (西格玛)是目标的雷达散射截面。
- c 是光速。
- r 是目标到雷达的距离。
- fc 是雷达频率。
- 
在方程中，Pt和Pr 分别表示雷达的发射机（Tx）功率和接收机（Rx）功率Gt 和Gr 分别是Tx和Rx的天线增益。回想一下，σ 是目标的雷达散射截面（RCS），r 是目标的距离fc 是载波频率这种信噪比随距离增加而下降的情况在雷达应用中是一个关键的考虑因素，因为它影响了系统检测和准确估计与目标相关的参数的能力。

![[Pasted image 20231209115641.png]]

- 当目标距离为0.3米时，由于高回波信噪比，DE和WT方法也可以获得较好的测量结果，除了提出的方法之外。当目标距离大于0.3米时，与提出的方法相比，其他比较的方法获得的监测准确性显著降低，而提出的方法则能够保持较好的监测结果。
- 
![[Pasted image 20231209115812.png]]



- 图15显示了提出的方法随着距离的变化的监测成功率、平均误差和均方误差（MSE）。在1.2米范围内，提出的方法能够获得100%的监测成功率，并且在1.8米内能够保持在90%以上。尽管当目标距离大于1.8米时，MSE增加并且监测成功率显著降低，但平均误差仍然保持在10%以内。在长时间监测过程中，平均心率监测值可以保持在可用状态。



###### 5.3 不同受试者


![[Pasted image 20231209120103.png]]
性能3（不同受试者）：如前所述，当考虑个体差异时，平均静息心率具有不同的分布。此外，不同受试者的呼吸和心跳模式的变化可能会影响心跳检测的有效性。为了验证所提出的神经网络模型在不同受试者面前进行心跳监测的泛化能力，三名受试者参与了泛化验证实验。对于每个受试者，心率监测持续15分钟。图16描述了使用四种不同方法对每个参与者进行的心率估计的成功率Ps​。在所有情况下，所提出的算法的检测成功率明显高于其他三种方法，成功率超过93.3%。

###### 5.4  长时间的检测

![[Pasted image 20231209121155.png]]

在图17(a)、(c)、(e)和(g)中，比较了雷达估计和联系的PPG的瞬时心率值。在图17(b)、(d)、(f)和(h)中绘制了雷达-PPG平面中的样本点云，理想情况下所有样本都位于y=x线上，表示雷达数据与PPG数据相同。表VI详细比较了所提出的方法与其他方法在长时间连续心率监测方面的结果。实验结果表明，作为基准的FFT滤波方法和MRC方法在长时间监测应用中性能较差，无法获得可接受的测量精度。数据分布在较低的心率范围（低于y=x线），这是由于呼吸的未抑制谐波干扰引起的。EMD方法可以获得更接近真实值的心率平均值；然而，模态混叠问题导致相邻的IMF波形混叠和相互影响，难以识别，导致监测成功率Ps较低。为了解决模态混叠问题，我们还进行了EEMD方法和基于VMD的方法。结果显示，虽然它们比EMD方法好，但仍然无法达到我们提出的方法的效果。DE、CS-OMP和小波方法可以获得更接近真实值的心率平均值，但由于MSE较大，它们的监测成功率Ps较低。它们的估计结果稳定性较差。端到端的DL方法（mBeats）表现不佳，因为从端到端训练方法学到的表示在数据以低信噪比生成时无法很好地转移或泛化。相比之下，本文提出的HeRe方法在所有统计参数中都有更好的结果。如图17(g)所示，阴影区域表示从参考心率值的±4 BPM的区域，表明大多数样本在此误差范围内，而在这4小时的监测中，成功率Ps高达97.5%。


![[Pasted image 20231209121352.png]]


验证了他更精确

##### 6 结论

- 在这篇文章中，我们提出了一种基于深度学习的信号重建方法，即HeRe，它将心跳信号重建问题转化为信号模式检测问题。该方法显著提高了来自低功率雷达的心跳信号的信噪比，从而通过频域分析和基于历史数据的当前预测修订实现了更精确的心率估计。高精度和强韧性以前只能通过高功率雷达系统实现。我们进行了多个实验，以展示我们的方法在增强心跳信号方面的效能，并将其与先前的实际监测工作进行比较，该方法提供了更准确的估计。为了满足家庭监测的使用场景，我们进行了一系列实验，涵盖不同心率分布，在常见心率范围内保持了90%以上的准确率。在最低90%准确率限制下，最远的测量距离为1.8米。当监测不同参与者时，准确性略有下降，但仍保持在93.3%以上，表明其对不同人体的良好适应性。总体而言，我们的方法能够在所有情况下实现最佳准确性。我们还进行了240分钟的长期心率跟踪实验，以证明我们的方法保持高度稳定性，平均准确率为97.5%。此外，由于我们的方法不需要对原始雷达数据进行特定资格的认证，我们认为该方法可以轻松适应其他雷达平台，并在高性能、高信噪比雷达平台上实现更高的心率监测准确性。所提出的方法还有潜力通过识别个体心跳信号来提供可靠的心率变异（HRV）测量，这个问题将在随后的研究中进行评估。
 
- 尽管所提出的方法 HeRe 利用当前最低功率的毫米波雷达提供了良好的心率监测准确性，但仍然存在一些在未来必须解决的重要挑战。在人体移动的环境中监测生命体征是其中最具挑战性的任务之一。传统的信号处理技术通常难以有效消除由小的身体运动产生的噪音，这种噪音可能比呼吸和心跳引起的胸壁表面振动更显著。此外，由于运动的多样性，使用本文提出的方法难以表示这些运动。因此，无监督的深度学习方法，不需要用于训练的参考信号，对于未来的研究显示出巨大的潜力，因为它们可以在受试者运动时甚至无需接触传感器的情况下收集训练数据集。相关研究中的大多数实验都是在实验室设置中进行的，并且具有明确定义的距离。在家庭环境中，其他个体和物体可能会干扰心跳信号。相信通过引入空间感知和通过MIMO雷达系统进行波束形成将解决这个问题，因为它比传统的毫米波雷达具有更高的角分辨率。
- 以及静态的其他方位的采集。
  