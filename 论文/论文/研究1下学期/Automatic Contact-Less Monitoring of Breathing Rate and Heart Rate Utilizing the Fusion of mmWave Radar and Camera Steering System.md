
利用毫米波雷达和摄像头转向系统的无接触式呼吸率和心率自动监测

### 1 摘要
#### 1.1 摘要内容
医疗服务的高需求和现场人员的稀缺，测量过程必须在无人监督的条件下实现自动化，且需保持高可靠性和准确性。本文提出了一种新颖的自动化方法，用于通过毫米波雷达测量呼吸率和心率，并利用机器学习对这两个重要生命体征进行分类。该系统集成了频率调制连续波（FMCW）毫米波雷达和全方位可调（PTZ）摄像头，自动化摄像头的转向并将雷达对准面向摄像头的人。然后，获取的信号被输入到深度卷积神经网络中，将它们分类为呼吸和心脏信号，分别为低、正常和高，共计六个类别。此分类可由医疗人员用于医疗诊断。获得的平均分类准确率为87%，精确度、召回率和F1得分为0.93。

#### 1.2 关键字 
- 呼吸率分类、呼吸率传感器、连续小波变换、深度卷积神经网络（CNN）、心率分类、心率传感器、机器学习、毫米波传感器。
- ***Breathing rate classification, breathing rate sensor, continuous wavelet transform, deep convolutional neural network (CNN), heart rate classification, heart rate sensor, machine learning, mmWave sensor***


### 2 intRoduction
- 呼吸率、心率、血压和体温是四个主要的生命体征，必须准确测量和分类，以诊断多种疾病[1]。呼吸率是指一分钟内个体的呼吸次数。表I显示了正常、低和高的呼吸率。异常的呼吸率是潜在疾病的早期迹象，需要迅速的医疗关注
- ***BREATHING and heart rate, blood pressure, and temperature are the four main vital signs that must be accurately measured and classified in order to diagnose a variety of diseases
- 脉搏或心率是指每分钟的心跳次数，可分类为低、正常、略低和高，如表II所示。监测这些重要信号对医学诊断和治疗至关重要。因此，实时监测呼吸和心率是必需的。文献中有许多测量方法。
- ***refers to the number of heartbeats per minute and can be classified as low, normal, slightly low, and high, as shown in Table II. Monitoring these vital signals is critical in medical diagnosis and treatment. As a result, real-time monitoring of breathing and heart rate is essential.
- 表1正常的呼吸范围![[Pasted image 20240517185447.png]]
- 表2心跳范围![[Pasted image 20240517185602.png]]
- 呼吸率是潜在疾病的最早指标之一，对于心脏异常、严重烧伤、老年人健康护理、睡眠监测[5]、心理健康或任何可通过生命体征异常确认的传染病[6]，它比体温、血压和脉搏更有效的指标。因此，其检测在许多医疗跟踪应用中有广泛用途。雷达技术不仅确保了非接触式监测，而且可以处理原始雷达信号并提取更集中的信息，这对医疗应用很有用，同时也能检测呼吸和心跳信号的变化，以便早期预测疾病[5]。
- ***he breathing rate is one of the earliest indicators of an underlying disease and is a better indicator than temperature, blood pressure, and pulse [4] for cardiac abnormalities, severe burn, elderly healthcare, sleep monitoring [5], psychological wellness, or any infectious diseases [6] whose presence can be confirmed with abnormalities in vital signs. As a result, its detection has many medical tracking applications where the setup can be used. Radar technology not only ensures noncontact monitoring but raw radar signals can also be processed and more centralized information extracted, which is useful for medical applications, as well as detecting changes in breathing and heartbeat signals to predict disease at an early stage [5]


#### 2.1 Existing Solutions 存在的解决方案
 1. 接触式监测[7]：接触式监测是测量生命体征的传统方法，通常涉及患者的皮肤与传感器接触
   1) 根据接触类型，接触式方法的准确性可能较低。例如，由于存在三聚氰胺，皮肤较深的色调可能导致血氧仪显示较高的氧气值。因此，可能有多种生物因素影响接触结果[7]。
   2) 接触式方法通常需要医务人员在场，例如测量心电图（ECG）信号。
   3) 由于与身体的多次接触，患者经常感到不适。
   4) 医生使用听诊技术通过听诊器测量呼吸率。这一过程依赖于医生，这降低了准确性[7]。
   5) 如图1所示，大多数接触式模型基于需要与皮肤接触的光学或电子传感器
由于其主观性，一些接触式方法可能会导致误诊。
表1 
![[Pasted image 20240517190716.png]]
2. 非接触式：由于接触式方法给患者带来的不便，如皮肤刺激和普遍的不适感，非接触式生命体征监测变得流行
   1) 由于基于相机的系统需要足够的光线捕捉并且处理成本高，基于雷达的系统因其鲁棒性而成为优秀的选择[7]
   2) 现有的解决方案，如图1所示，使用雷达系统，但要求被测量者位于雷达的视野范围内，这称为手动转向[8]。

#### 2.2 本文系统的内容
本文提出了一种系统，该系统在所需时间内提高了检测生命体征的准确性，采用了非接触式架构，并自动化了整个过程，从而消除了医务人员的需求。本工作的主要贡献如下:
- ***提出了一种新颖的自动非接触式测量呼吸和心率的方法，使用了毫米波频率调制连续波（FMCW）雷达和全景倾斜变焦（PTZ）摄像头。
- ***利用提出的新设置创建了一个新的数据集。
- ***数据集使用连续小波变换时频分析技术进行预处理。
- ***使用轻量级卷积神经网络（CNN）将测量的生命信号分类为六个不同的类别：呼吸的低、正常和略低，心率的低、正常和略低。


### 3 相关工作
1. **雷达监测系统**：通过实现超宽带（UWB）雷达的算法，提出了一种新方法，结合峰值能量函数和经验分解方法共同提取心脏和呼吸信息。
2. **无线技术与生命信号监测**：描述了“Vital radio”技术，这是一种无线技术，设备安装在房屋墙壁上，能准确测量呼吸和心率。还提到了正在开发中的聚合物光纤传感器，这种传感器佩戴在被测者身上，利用各种信号处理技术提取和过滤信号。
3. **非接触式监测方法的重要性**：由于COVID-19大流行，开发了一种非接触式监测系统，使用峰值检测和快速傅里叶变换（FFT）等处理技术对信号进行分类。此外，还提到了使用接近传感器在被测者无意识状态下测量呼吸率的技术。
4. **面部检测算法和雷达应用**：提出了一种利用面部检测算法捕捉人体胸部区域的非接触式生命体征测量方法。此外，还讨论了雷达用于连续非接触监测生命体征的方式及毫米波雷达暴露的潜在后果。
5. **心电图（ECG）和体动图（PPG）技术的应用**：介绍了一个低成本便携式PPG系统，用于检测心血管活动，并将传感器数据与ECG读数进行比较。还有一个着重于PPG技术的工作，该技术将传感器集成在手环中，用于在体力活动中监测心脏波形。
6. **呼吸状态监测与睡眠监控系统**：展示了基于地震心动图的传感器，用于测量呼吸状态，并将其分类为正常、长时间劳累或呼吸急促。还设计了一种基于压阻传感器和机器学习的睡眠监控系统，重视定期监控呼吸频率，准确性约为97%。
这些内容强调了监测心率和呼吸率的技术进步，以及非接触式方法相比接触式方法在舒适度和简便性方面的优势。同时，提出的技术和方法在提高医疗监测精度和便捷性方面展示了显著的前景。
### 4 系统概述

***提出的想法使用一个如图2所示的摄像头支架，安装在如图3所示的FMCW雷达上，以自动方式捕捉人的心率和呼吸率。在这种情况下，如图4所示，被监测的人必须面对摄像头，且可以是任何方向。这将通过在一个具有360度旋转功能的PTZ摄像头上安装雷达来实现。摄像头将旋转至面向该人，并聚焦于胸部以固定雷达。雷达随后将利用胸部位移来准确测量呼吸和心率。通过集成连接到摄像头PTZ属性的Amcrest API，将启用自动转向功能。在获取心率和呼吸率信号，并使用时频技术进行预处理后，这些信号将以图像的形式传递给CNN模型，以分类为正常、高和低（呼吸）以及低、稍低和正常（心率）的生命体征呼吸和心跳.***
图2 摄像头支架
![[Pasted image 20240517195025.png]]
图3 FMCW雷达所示图
![[Pasted image 20240517195112.png]]

#### 4.1 系统的工作原理 
上述设置依次按照以下步骤工作：
1. PTZ摄像头在房间中检测到人后，使用OpenCV和API输入的面部检测和转向代码，向该人转向。
2. 当摄像头检测到人时，它会停止移动并聚焦于该人，保持静止状态，直到雷达开始并停止测量胸部位移。
3. 雷达通过测量特定范围内的相位差感知振动或胸部位移。使用图形用户界面（GUI）来测量心率和呼吸率。
4. 在使用时频技术CWT进行数据预处理之前，会获得呼吸和心脏信号的数据点，并以表格格式存储。
5. 预处理后的数据被输入到深度卷积神经网络（CNN），以对呼吸和心率进行分类。


### 5 硬件设置
本节提供了雷达安装在PTZ摄像头上的细节，AWR1443BOOST和PTZ摄像头的技术描述，以及FMCW雷达和雷达集成的相关信息。

#### 5.1 摄像头支架
在本文提出的新型设置中，雷达安装在PTZ摄像头的曲面上。为实现这一点，需要创建一个摄像头支架，使其贴合在摄像头表面，并为雷达提供一个平坦的安装面。因此，如图2所示，摄像头支架的设计在AutoCAD中完成，并进行3D打印。
之后，通过多次迭代在AutoCAD中进行设计，因为摄像头支架的内表面应完全贴合摄像头，即使雷达安装在上面，也能减少沿表面的滑动，如图3所示，从而增加重量。

#### 5.2 技术描述 
表III显示了AWR1443BOOST的技术细节[26]。  
表IV显示了Amcrest IP4M PTZ摄像头的技术细节[27]。
![[Pasted image 20240517200243.png]]

![[Pasted image 20240517200255.png]]

#### 5.3 FMCW 雷达  
##### FMCW雷达的优点 
  1. FMCW雷达是一种通过调制发射信号来随时间改变其工作频率的雷达传感器[28]。由于FMCW雷达能够以高精度测量小范围、同时测量距离和速度、以及由于低中频而具有低处理需求，FMCW雷达被广泛使用[29][30][31]。它通过检测反射的发射信号进行工作，如上所述，该信号是频率调制的[30][33]。该频率调制的发射信号[34]与反射信号一起产生了拍频（接收信号和发射信号之间的频率差），如图5所示。通过确定拍频信号的相位变化，可以计算雷达天线与反射物体之间的距离，如下所示
##### 信号的处理
 1.  发射的信号为[35]:
     $\[ p(t) = e^{j\left(2\pi f_s t + \pi \frac{B}{T} t^2\right)} \]$
    这个公式表示发射信号 \( p(t) \) 是一个频率调制连续波（FMCW）信号。具体来说，这个公式描述了随时间 \( t \) 变化的复指数信号。以下是每个部分的详细解释：
    $\[ p(t) = e^{j\left(2\pi f_s t + \pi \frac{B}{T} t^2\right)} \]$
    - $( p(t) )$：发射信号。
    - \( e \)：自然对数的底数，约等于2.71828。
    - \( j \)：虚数单位，满足 $( j^2 = -1 )$。
    - $( f_s )$：起始频率。
    - \( t \)：时间变量。
    - \( B \)：信号的带宽。
    - \( T \)：信号的时间周期。
    这个公式的具体形式表明，信号的相位是时间的二次函数。这种类型的信号是频率调制连续波（FMCW）雷达中常用的，用于测量距离和速度。
    - 第一部分 $( 2\pi f_s t )$：线性部分，表示信号的起始频率 \( f_s \)。
    - 第二部分 $( \pi \frac{B}{T} t^2 )$：二次部分，表示频率随着时间 \( t \) 线性增加，带宽为 \( B \)，时间周期为 $( T )$。
    这两部分结合起来，构成了一个随着时间频率不断变化的信号，这样的信号可以通过测量发射信号和反射信号之间的频率差来确定目标物体的距离和速度。
 2. ***接收信号可以表示为[35]：***
     $[ r(t) = e^{j\left(2\pi f_s (t - t_w) + \pi \frac{B}{T} (t - t_w)^2\right)} ]$
     这个公式描述了接收信号的形式，以下是公式中每个部分的详细解释：
    - \( r(t) \)：接收信号。
    - \( e \)：自然对数的底数，约等于2.71828。
    - \( j \)：虚数单位，满足 $( j^2 = -1 )$。
    - $( f_s )$：起始频率。
    - $( t )$：时间变量。
    - $( t_w )$：时间延迟，代表信号从发射到反射再返回所经历的时间。
    - \( B \)：信号的带宽。
    - \( T \)：信号的时间周期。
    接收信号 $( r(t) )$ 是发射信号经过时间延迟 $( t_w )$ 后的形式。公式中的两个主要部分
    1. $( 2\pi f_s (t - t_w) )$：表示信号由于时间延迟 $( t_w )$ 引起的相位变化，这部分描述了起始频率和延迟时间的关系。
    2. $( \pi \frac{B}{T} (t - t_w)^2 )$：表示信号由于频率调制而引起的二次相位变化，这部分描述了带宽 $( B )$ 和时间周期 $( T )$ 对延迟时间 $( t_w )$ 的影响。
      
    通过对比发射信号和接收信号，可以测量出信号传播的时间延迟 $( t_w )$，从而计算出目标物体的距离。
 3. 拍频信号通过对上述信号进行变换和滤波得到，可以表示为[35]
     拍频信号可以表示为：
    $[ b(t) = p(t) r(t) \approx e^{j\left(\frac{4\pi B R}{cT} t + \frac{4\pi R}{\lambda}\right)} = e^{j(2\pi f_b t + \phi_b)} ]$
    - \( b(t) \)：拍频信号。
    - \( p(t) \)：发射信号。
    - \( r(t) \)：接收信号。
    - \( B \)：信号的带宽。 
    - \( R \)：雷达天线与反射物体之间的距离。
    - \( c \)：光速。
    - \( T \)：信号的时间周期。
    - \( \lambda \)：信号的波长。
    - \( f_b \)：拍频。
    - \( \phi_b \)：拍频的相位。
    其近似等于一个复指数函数，其中包含了频率和相位的信息。通过测量和分析拍频信号，可以计算出目标物体的距离 \( R \) 和相位变化。
    其中 $( t_w = \frac{2R}{c} )，( f_b )$ 是拍频，$( f_s )$ 是起始的频率
    
    以下拍频信号的方程给出了拍频 \( f_b \) 和相位 \( \phi_b \)。相位通过拍频信号 \( b(t) \) 的快速傅里叶变换（FFT）得到，相位的变化可以通过以下方程找到距离的变化[36]：
                $\Delta \phi_b = \frac{4\pi \Delta R}{\lambda}$  (4)
    -  Δϕb​ 是相位变化 
    -  λ 是波长，
    -  ΔR 是距离的变化。
     雷达信号通过啁啾（chirp）进行测量，即信号的频率随时间变化（增加或减少）[37]，这是由于传感器对啁啾信号的高响应性[8]。在这种情况下，频率在一个频带范围内移动或变化[37]。
    FMCW雷达根据以下公式计算反射发射信号的物体距离 $R$ [30]
    距离 \( R \) 的计算公式为：
      $R = \frac{c_0 |\Delta t|}{2} = \frac{c_0 |\Delta f|}{2 \left( \frac{d(f)}{d(t)} \right)}$  (5)
     其中：
    - \( c_0 \) 是光速，约为 \( 3 \times 10^8 \) 米/秒，
    - \(\Delta t\) 是时间延迟，
    - \(\Delta f\) 是频率变化，
    - \(\frac{d(f)}{d(t)}\) 是频率随时间的变化率。 
     这个公式描述了通过测量频率变化和时间延迟来计算目标物体的距离。

*AWR1443 FMCW雷达是雷达模块的理想选择，因为它能够在低功耗下运行，并且对较小的运动提供更高的检测精度[26]。因此，它非常适合用于自我监控的自动化系统。在此工作中，雷达检测胸部位移的振动，捕捉心脏和肺部的活动，并提供呼吸和心率。雷达检测从人体胸壁反射的电磁波，并测量由心跳或呼吸引起的胸部位移或振动[8]。利用雷达测量和相位展开，可以获得一个与胸部位移相关的信号，使用公式(4)来表示。这个信号非常有用，因为它包含了与身体呼吸和心跳相关的信息。
 


#### 5.4 Radar Integration 雷达集成
*TI mmWave传感器测量了站在雷达前方的人的胸部位移或振动。 AWR1443核心滤除噪声，并从胸部的振动中提供清晰的呼吸和心跳图，并估算心率和呼吸率的值。 图6详细描述了使用AWR1443BOOST从人的胸部获取呼吸率和心率信号的逐步过程[35]。具体描述见下文[35]。*
 图6 获取心率和呼吸率的功能![[Pasted image 20240517212046.png]]
1) 雷达提供ADC数据，经过FFT变换产生距离轮廓。
2) 计算距离箱的最大值，有助于确定必须采集读数的实际对象。
3) 从距离数据中提取相位值，然后与不同的时间值相对比。
4) 如果连续相位值之间的差异大于π或小于-π，则通过增加或减去2∗π来修正这一相位，然后根据此未经包装的相位计算位移。
5) 计算未经包装相位之间的相位差。为了消除这些未经包装相位估计中的脉冲噪声，计算向后和向前的相位差。假设当前相位为b(m)，则向前相位差可以计算为b(m) − b(m + 1)，向后相位差为b(m) − b(m − 1)。如果计算出的相位差仍然超过阈值，则将其替换为近似值[35]。

***为了获得呼吸率波形，一个频率范围为0.1-0.5 Hz的带通滤波器被连续应用于实时输入数据。接着是谱估计，包括FFT、自相关和峰间隔确定。最后，利用三种谱估计滤波技术中最可能的置信区间来计算呼吸率。

**除了上述步骤外，为了获得心率波形，还执行以下步骤[35]。
1) 在实时输入数据上连续应用频率范围为0.8–4 Hz的带通滤波器。
2) 为了提高心率估计的准确性，通过一个运动干扰段去除块来减少信号中的大幅度冲击。信号被分成20个段，如果这些段的能量超过定义的能量阈值(E > ETh)，则可以将其缩放(ETh /E)1/2，或者忽略这些段。
3) 执行谱估计，包括FFT、自相关和在自相关数据上确定峰间隔。
4) 心率决策基于考虑了所有三种不同谱估计滤波技术的最可能置信区间。心率决策还基于获得的呼吸率决策。

***图7所示的GUI显示了呼吸率（BR）和心率（HR），以及胸部位移、呼吸和心跳模式。通过从心跳信号中提取相位，并在慢时间轴上解包相位并进行采样，使用表V中提到的参数中的两个中的一个对处理进行处理，从而获得了生命体征的波形[35]。然后，通过将表VI和VII中显示的配置通过通用异步接收器转发器（UART）数据包发送，如图8所示，将雷达集成。这些数据已被提取出来，以便使用机器学习进行进一步处理和分类。***
图7 GUI
![[Pasted image 20240517212821.png]]


### 6 软件算法
***本节讨论了人脸检测和HAAR分类器的步骤，以及PTZ摄像头的集成，其中描述了连接摄像头和摄像头转向的方法。***
#### 6.1 人脸检测和HAAR分类器
This algorithm [38] has two significant steps:
1. training;
2. classification.
训练过程使用背面和正面标记的图像（没有人和有人）。识别过程使用“HAAR特征”[39]，它们是具有暗色和亮色像素的特征矩形。每个特征被赋予一个值，即暗色像素的总和与亮色像素的总和之间的差异[38]。

像素值 = (SODP/NODP) − (SOLP/NOLP) (6)
其中，SODP是暗像素的总和，NODP是暗像素的数量，SOLP是亮像素的总和，NOLP是亮像素的总数。在预标记图像上训练的分类器从图像中提取相关特征以减少错误。最终的分类器是其他加权弱分类器的总和（这些分类器不能单独对图像进行分类，而是通过总和工作来提高分类的准确性）[38]。与将所有获得的特征应用于图像不同，采用级联分类器，根据预定义的标准将特征分组到不同的分类器中，然后应用于图像以减少计算量[38]。一个相关的特征被称为弱特征，当它们相加时构成分类器[38]。随后，许多这样的分类器被级联起来以提高准确性和检测速度，并且消除负面特征。
人脸检测使用OpenCV [40]实现。为了检测对象，HAAR分类器从图像中提取特征，每个像素都使用公式(6)计算。由于HAAR分类器在计算上较为廉价且性能优于其他分类器（例如LBP分类器），因此被广泛使用[40]。

#### 6.2  PTZ摄像头集成

Amcrest提供的PTZ摄像头可360◦旋转，90◦左右旋转，并具有16倍变焦[27]，当与雷达集成时，可以增加其视野，并使其能够捕捉人体在任何方向（静止）的数据。它还具有其他功能，如夜视、摄像录制和运动检测[27]。摄像头通过RSTP协议连接到代码。
PTZ摄像头是新设计中的关键组件，因为它通过朝向人的方向自动捕捉，消除了需要人在雷达的画面中以进行准确检测的必要性。它使雷达能够自动朝向人并捕捉呼吸和心率等重要生命体征。系统中使用的PTZ摄像头实际上是一个RGB摄像头。在低光条件下，RGB摄像头有一些限制。未来，可以将热成像摄像头和/或夜视摄像头集成到系统中，以提高在低光条件下的系统可靠性。
1) 连接摄像头：PTZ IP摄像头可以通过以太网电缆、Wi-Fi或蜂窝网络连接到互联网，并支持Web应用程序集成。在提出的设计中，IP摄像头通过以太网电缆连接到2.4 GHz频率的路由器。连接摄像头后，可以通过移动应用程序在所需的频道上访问实时视频流。
摄像头连接到互联网后，通过RSTP协议将其链接到Jupyter上的OpenCV代码，并获取其IP地址（通过移动应用程序获取）。在成功连接后，可以在连接的PC上访问实时视频帧。
2) 传递视频帧和线程：视频帧通过cv2.VideoCapture()函数传递，并通过随机生成树协议（RSTP）和URL连接到摄像头。然后将视频帧传递给rescaleframes函数，因为获取的视频帧是一个放大的帧。该函数通过传递为25的缩放因子来重新调整帧形状，这意味着显示了25%的帧。选择此数字是因为它提供了整个视频流的完整视图。cv2.VideoCapture()收集每一帧，然后阻塞剩余的Python代码，导致显著的延迟。为了减少延迟并增加帧率，使用了线程。线程用于创建两个彼此独立的线程。第一个线程捕获帧，而第二个线程执行剩余的转向代码。
3) 自动摄像头转向：自动转向有两个主要步骤。
1) 首先，它检测一个人的脸，并持续扫描直到找到一个；一旦检测到一个人，它就会停在人的脸前。人脸检测算法计算矩形的中心以找到脸的中心，并使用边界矩形返回脸的坐标。
2) 然后，它调用位置API使用moveCamera()，传递脸部中心的坐标，并根据从faces变量传递给位置调用函数的x和y坐标调整摄像头到胸部区域。使用movecamera()用户定义的函数调用StopTour()和StartTour() API来停止摄像头在人物面前，并根据传递给它的参数更改API返回值。然后，可以将雷达定向到胸部区域。在进行测量时，人必须保持静止；这是整个系统的要求。个人可以处于任何方向，但必须保持静止。
moveCamera()函数使用来自Amcrest文档[41]的URL语法，使用GET、请求和超文本传输协议（HTTP）摘要身份验证，使用用户通过Amcrest应用程序为摄像头分配的用户名和密码连接到服务器。

#### 6.3 数据集详细信息和预处理
*数据来自12个人（其中一个人做过胸部手术，其余人健康）。每个受试者被要求以低、高和正常速度呼吸近一分钟，每次测量在十种不同的方向进行，每个受试者每种方向进行30次测量，形成一个包含720个测量值的数据集。如表VIII所示，这些数据是不平衡的。十种不同的方向包括靠近雷达（大约0.3米）、远离雷达（大约1米）、左侧坐、右侧坐以及任意随机方向（例如，一个人在阅读时使用手机并不知道数据采集过程），然后，以站立姿势重复相同的方向。获取的数据在GUI上进行监控，并绘制原始波形的位移（a.u）与时间的图表。然后，使用CWT对此数据集进行预处理，以获得频率与时间的图表；这也大大减小了图像大小，并使数据集变得轻量级。*

![[Pasted image 20240517213909.png]]

**预处理连续小波变换**
小波变换对瞬态信号非常准确，例如ECG信号、呼吸波形、心脏波形或任何其他实时生命体征波形，因为它们提供了有关每个时间步的信号的转换信息，具有准确的频率信息[42]。在这种转换中，信号的一个小部分，即小波，通过改变其尺度因子的幅度和频率而变化，并通过将尺度因子与信号相乘而在主要信号上滑动[43]。顾名思义，CWT是一种变换，在这种变换中，小波通过尺度因子（具有无限的值和可能性，使其连续而不是离散）变换，并比较滑动函数与信号之间的相似性[44]。通过变化c和d，如下式所示，可以获得CWT信号T(c, d)的系数[42]： T(c, d) = 1/√c ∞−∞ x(t)ψ¯∗(t − d)/c dt (7) 其中，x(t)代表信号，ψ代表母小波，操作涉及其复共轭，c是尺度因子，d是移动因子。尺度变换是通过将信号与尺度因子相乘来压缩和膨胀信号，并获得许多新的信号（在这种情况下，是无限的，因为有无限多种缩放的可能性），这证明了小波变换的一个优点是有许多选项可供选择，取决于应用[42]，[43]。一个小的尺度因子产生一个具有快速变化值和高频率的压缩信号，而一个大的尺度因子产生一个具有缓慢变化值和低频率的膨胀信号[42]。应根据应用选择大或小的尺度因子。CWT是图像压缩的一个很好的选择，因为可以通过调整尺度因子来获得所需的压缩类型[44]。图11显示了测得的心率数据及其对应的预处理CWT图像。每个图像由固定数量的数据点构成，即128个，跨越64秒，给出了采样频率（1秒内的采样数）为2 Hz（128/64 = 2）。收集的数据集以数据点的形式存在，然后转换为绘图，并通过CWT处理。


#### 6.3CNN模型和训练
深度卷积神经网络（CNN）在图像分类中被广泛使用，它利用卷积层[45]，其中特征在输入数据上进行卷积。在CNN中，特征是在训练期间学习的，不像手动训练那样，这使它们成为CV应用的理想选择[46]。在卷积层之后，创建特征图并使用批量归一化层[47]对其进行归一化以稳定输出。在归一化输出上，应用激活层[48]以增加模型的非线性，使其更适合于实际数据[46]。最大池化[49]层是下一层，其中计算像素强度的最大值并返回给核心，从而减少了计算量、过拟合，并增加了模型的方差以预测所有条件[46]。
接下来是展平层，在此层中，特征图被转换为一维向量，进一步将其作为输入传递到最终层[50]。最终层通常由一系列dropout和dense层组成。dropout层用于通过引入可用数据集的一部分来放慢训练过程，这些数据集将用于训练或不用于训练[51]。最后一层是全连接层或密集层[48]，其中网络中的每个神经元都连接到网络中的每个其他神经元。它使用上一个图像的输出输入到下一个图像中[46]；它使用softmax激活，然后将其分类为最终的类别数。
提出的2-D CNN模型是轻量级模型，具有按顺序排列的卷积层和批量归一化层，然后是最大池化、dropout和reLu激活层。参考模型中使用了两个这种层组织的集合，如图12所示。卷积层的过滤器大小为3，输入图像将设置为128×128的尺寸，给模型提供128×128×3的输入形状。在卷积层之后使用批量归一化层来放慢训练速度，并通过对输入层进行归一化来使学习稳定。最大池化层的大小为2×2，dropout层设置为0.2和0.3，一些层设置为0.4。具有最高参数数量的层使用L2正则化，速率为0.005，以减少过拟合。最终层是一系列dropout和dense层，导致输出分类为六个类别，即breathlow、breathnormal、breathhigh、heartlow、hearthigh和heartnormal。最后，使用输出层，其中包含具有softmax激活的密集层，因为它有助于在多类别情景（大于2）中正确识别（在我们的情况下是6）。参考模型的每个层的层次结构和输出形状在表IX中列出。
表IX所提出模型的输出形状和每一层参数数量的总结
![[Pasted image 20240517214729.png]]

**训练**
表IX所示的模型在Google Compute Engine上进行训练，使用Adam优化器和输出层的softmax激活函数，学习率为0.00001，批量大小为16，共训练100个周期。数据集通过k折交叉验证方法自动分为测试集和训练集[52]。训练结果在结果部分进行讨论。选择的“k”值为10，从而在测试和训练之间产生十种不同的数据分割，生成十种不同的模型。最终选择具有最佳准确性和较少过拟合的模型作为分类适用模型。


### 7 结果和讨论

所提出的深度CNN在我们自己获取的雷达数据集的六个不同类别上进行了训练。图13显示了这六个类别的混淆矩阵——低呼吸、正常呼吸、高呼吸、低心率、正常心率和略低心率。矩阵显示，低心率的分类准确率为93%，正常心率的分类准确率为96.5%，略低心率的分类准确率为93%，正常呼吸的分类准确率为91%，低呼吸的分类准确率为91%，高呼吸的分类准确率为96%。低呼吸和正常呼吸类别在样本类型上非常接近，并且由于进一步的不平衡，低呼吸在某些情况下被错误分类为正常呼吸。

图14突出了模型在训练折叠9时的训练和验证准确率与周期的关系。图14显示了所提出的深度CNN模型的训练和验证准确率。图表显示，验证准确率的增加相当稳定，导致训练准确率在某些周期后超过了验证准确率，这表明有轻微的过拟合，可以通过更为多样化的数据集来解决。验证损失在一段时间后变得恒定，不像训练损失那样呈指数下降。

表X显示了所提出的CNN模型在所有十个训练分割上的验证、测试和训练准确率。在某些折叠中，验证准确率高于测试准确率；在某些折叠中，测试准确率更高，但训练准确率大多高于两者，而某些折叠中三种准确率的差异较小，显示了一个稳定的模型折叠，例如折叠2。表XI显示了本文中考虑的所有模型的精确度（P）、召回率（R）和F1得分。由于数据不平衡，精确度、召回率和F1得分也成为模型性能的重要指标。可以观察到，类别4（低呼吸）具有最高的精确度，为0.95，这表明该类别非常准确地对应其真实值。类别1和类别5（正常心率和高呼吸）具有最高的召回率，约为0.96，这表明这些类别被正确识别。类别1（正常心率）的F1得分为0.95，显示该类别在预测时与未见数据的接近程度最高。所有精确度、召回率和F1得分的平均模型分类值降至0.93，这个值很好，表明模型在预测获取的数据方面非常成功。

图13
![[Pasted image 20240517215625.png]]在这篇文章中，提出了一种新颖的非接触式自动方法，用于测量和分类心率和呼吸率。使用所提出的新设备创建了一个数据集。该数据集包含720次测量，使用CNN模型被分类为六个类别，准确率为87%。通过扩展数据集，未来可以提高系统的准确率。