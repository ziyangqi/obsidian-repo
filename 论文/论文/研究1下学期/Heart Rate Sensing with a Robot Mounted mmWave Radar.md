

#### 1 摘要

1、提出机器人搭载mmWare监测心率，在不干扰用户日常活动的情况下，以不同的用户姿势提供定期的心率测量。
2、搭载mBeats模块可以自适应地调整传感器角度以获得最佳反射配置 mBeats还具有深度神经网络预测器，可以从下肢估计心率。
3、应用场景mBeats可以为家庭中的许多后续医疗应用提供支持，例如姑息治疗、术后康复和远程医疗。


#### 2 介绍

*背景1 Heart rate monitoring is a key indicator for assessing health, stress and intness

心率监测是评估健康、压力和健康程度的关键指标。特别是，对于老年患者、姑息治疗中的患者或正在进行术后康复的患者进行定期（例如每小时）监测，提供了一个可量化的指标，用于确定是否需要来自健康专业人员的干预[1]。随着越来越多的患者选择在家中接受护理而不是在医院里，这变得越来越重要，因为这样更具成本效益[2]。

*背景2 Although wearables are an excellent solution for the general public, for the aforementioned problems they suffer from `forget to wear' and `forget to charge' issues. This leads to low compliance, making them unsuitable for monitoring patients with physical or mental health issues. Alternatives include sensor-equipped beds [3] but these are limited to monitoring patients in a single location.


尽管可穿戴设备是一种对普通大众来说很好的解决方案，但对于前述问题，它们存在“忘记佩戴”和“忘记充电”的问题。这导致了低依从性，使它们不适合监测身体或心理健康问题的患者。替代方案包括配备传感器的床[3]，但这些只能用于监测单一位置的患者。



涉及隐私的问题，使用摄像头的技术


##### 1问题解决

我们证明了通过使用毫米波雷达，可以在用户的下肢（穿着衣物的情况下）测量心率

  
提出了mBeats，可以在整个家庭提供非接触式心率测量，无需任何固定基础设施，困难，*服务机器人通常身高较低，靠近地板，因此无法感知心脏本身。相反，我们证明了通过使用毫米波雷达，可以在用户的下肢（穿着衣物的情况下）测量心率。这是一个困难的信号处理挑战，因为雷达返回信号非常微弱。为了解决这个问题，我们依靠深度学习的进步来提取准确的心率测量结果*，与竞争方法不同的是，我们不仅提供了测量结果，还提供了不确定性指标。这对于提供可信赖的测量结果而不产生虚假警报，甚至更糟的是，不反映紧急情况至关重要


- 第一项利用毫米波雷达实现基于机器人的心率测量的工作
- 我们提出了一种反馈控制方法，以主动引导毫米波雷达进行最佳信号检测。
- 我们使用深度神经网络来处理雷达位移测量，从而准确测量下肢的心率。该网络可以提供与预测误差成比例的估计不确定性。
- 公开发布了mBeats的实现，包括代码和数据集。

#### 相关工作

***在本节中，我们将回顾基于非接触式的心率监测技术。***
##### A: 基于ECG的技术 Electrocardiogram-based Techniques

非接触式心电图测量采用电容式电极而不是传统的粘性电极，因此不必直接接触用户的皮肤。这种类型的传感器已嵌入到各种不同的物体中，例如床 轮椅驾驶座椅等。尽管比传统的基于电极的心电图技术少得多侵入性，但它要求用户必须与传感器非常接近（几厘米），从而限制了其适用性。

##### B:基于视觉的技术 Vision-based Techniques

基于视觉的心率测量已经得到广泛研究。在大多数这些方法中，首先检测和跟踪感兴趣区域（ROI），涵盖身体的各个部位[4]，[12]，[13]。随着心脏跳动，血液流动会导致人体皮肤上微妙的颜色变化，这些信息可以通过RGB摄像头捕获。红外摄像机也已用于心率检测[12]，[14]，[15]，甚至可以从瞳孔波动中提取心跳信息[16]。基于视觉的技术在睡眠监测[17]或使用网络摄像头进行远程医疗[18]等任务中表现良好，并对用户的负担最小。然而，它们只能在视线范围内工作，并引起隐私问题。基于RGB的系统通常也受限于充足的照明条件。

##### C 基于射频的技术 RF-based Techniques

基于射频的心率测量技术主要基于雷达和WiFi。各种类型的雷达，如超宽带脉冲多普勒雷达[19]、连续波雷达[20]和调频连续波雷达[5]，具有不同的工作频率和输出功率，已被用于此场景。这些技术测量用户皮肤的微小位移。雷达信号可以穿透许多种材料，因此可以对生命体征进行非视线测量。然而，信号强度会影响操作范围，导致了发射功率和测量距离之间的权衡[21]。WiFi技术被广泛用于基于射频的心率测量，因为大多数这些技术可以使用商业现成的WiFi设备实现，如路由器和笔记本电脑。通过捕获信道状态信息（CSI）[22]，[23]来估算用户皮肤的微小位移。然而，WiFi技术的准确性很大程度上受到用户位置和身体方向的影响[7]。


##### 总结我们方法的优势

- 通过将系统安装在低高度的移动机器人上，我们的方法与位置无关
- 我们能够利用毫米波雷达的高位移灵敏度在下肢测量心率，使系统非侵入性，即不需要在胸部高度
- 正如我们的实验结果所显示的那样，与基于信号处理算法和启发式方法的传统方法相比，我们的系统达到了最高的准确性



#### 论文中的系统

##### 使用的设备

*mBeats comprises of a robotic platform equipped with a mechanically steerable mmWave radar module. Without loss of generality, in our work we use a TI IWR6843 single chip mmWave radar, which operates by sending out a frequency modulated continuous wave (FMCW) chirp over a 4 GHz bandwidth, centred on 62 GHz. By measuring the time for the signal to return to a colocated antenna and correlating with the transmitted signal, it is possible to measure the range to reective objects with high accuracy (cm level). By computing the phase difference between successive scans, it is then possible to measure relative displacements with near micron-level accuracy [24].

mBeats由一个装备有机械可控的毫米波雷达模块的机器人平台组成。在我们的工作中，我们使用德州仪器的IWR6843单芯片毫米波雷达作为示例，该雷达通过在62 GHz中心频率上发送4 GHz带宽的调频连续波（FMCW）扫频信号。通过测量信号返回到同一位置天线的时间，并与发送的信号进行相关，可以高精度（厘米级）地测量到反射物体的距离。通过计算连续扫描之间的相位差异，然后可以以接近微米级的精度测量相对位移 [24]。



![[Pasted image 20240311111943.png]]
###### 1 User Tracking Module 用户跟踪模块

- 主要根据毫米波雷达的点云来识别确定用户的位置所在，然后跟踪用户
- 机器人将以一定的测量距离（本文中为0.5米）接近用户，并执行后续的感知操作

###### 2 mmWave Servoing Module 毫米波服务模块  (难)

- 与平面表面不同，直接面向用户并不能保证获得最佳的反射信号，因为小腿中的胫骨和腓骨会阻挡信号。此外，由于周围物体造成的多径效应，稍微偏离最佳方向可能会导致性能显著下降。因此，鉴于良好的测量距离，毫米波雷达的心率估计精度仍然很大程度上取决于观察角度（见图3）。
- 因此，该模块的目标是优化传感器角度，以获得来自患者下肢/小腿的最大信号反射。虽然旋转机器人本身是可能的，但根据当前服务机器人的能力，这样做很麻烦，并且会不精确地达到最佳角度。因此，我们根据反射的毫米波信号特性直接控制服务电机的传感器方向。


###### 3 Heart Rate Estimation Module 心跳估计模块

**Heartbeat Waveform Extraction:**

- 心跳波形提取：在将传感器旋转到最佳方向后，毫米波雷达开始通过测量相对于范围轮廓峰值的相位变化来感知用户皮肤的微小位移。然而，除了心跳波形之外，相位变化还包含由其他身体运动引起的信号，这可能导致错误的估计。考虑到心跳频率位于0.8到4Hz之间的范围[5]，我们在该模块中利用双二阶级联IIR滤波器[27]来提取心跳波形。提取的波形然后被用作下一个模块的输入。

**DNN Predictor**

![[Pasted image 20240311114613.png]]

与先前的工作不同，其中传感器面向用户的胸部，我们的毫米波雷达收集来自下肢的信号。对于每个心跳，胸部通常具有400微米的振幅，而下肢皮肤的位移只有大约80微米的振幅。因此，收集到的信号要弱得多，我们提取的心跳波形比先前的技术具有更不清晰的模式。直接使用这些波形来预测心率，例如通过峰值提取，是困难且容易出错的。深度神经网络最近已经成为一种强大的数据驱动技术，能够有效地学习数据中的潜在特征。因此，我们将心率估计问题构建为一个回归问题，并使用卷积神经网络作为预测器。虽然循环神经网络，例如长短期记忆网络（LSTM），被广泛用于建模时间信号，比如从IMU数据中重建行人轨迹，但它们的递归计算会产生大量的延迟，无法在我们的资源受限平台上提供及时的预测。考虑到这个实时性的考虑，我们的网络采用了三个轻量级的1-D卷积层，后跟两个全连接层，分别产生心率和不确定性。特别是，所有卷积层的核数、核大小和步幅分别设置为64、5和1。通过将心跳波形作为输入，窗口大小为10秒（200帧），预测器能够提供速率值和置信区间（以不确定性的形式）。图4说明了这个过程。



**Uncertainty Estimation**
基于通常用于捕获固有传感器观测噪声的aleatoric不确定性来量化我们模型的不确定性。


#### 实现 

  
为了重现我们的方法，我们发布了一个新颖的毫米波心率测量数据集以及我们神经网络的源代码：https://github.com/zhaoymn/mbeats。

##### 1 数据手机

###### A:数据收集系统
我们将毫米波雷达传感器安装在Turtlebot 2 [33]上。商用电机也安装在机器人平台上，我们使用它精确地控制雷达旋转，每次旋转1°。服务控制单元由Arduino Uno [34]实现。关于毫米波雷达，我们采用了IWR6843 ISK [35]，这是一款新兴的低成本单芯片传感器。毫米波数据和时间戳都被记录下来。在我们的实验中，我们使用了Polar H10，这是一款精确的心率监测胸带，用于地面真实标记。我们开发了一个安卓应用，通过蓝牙记录Polar H10心率数据和时间戳。我们将发布这个安卓应用供社区使用。雷达数据和Polar H10设备的数据被同步到相同的NTP时间。
###### B Selected Poses 选定的姿势

选定的姿势：根据2019年6月发布的美国时间使用调查[36]，人们每天平均在家中坐着或躺着/睡觉的时间为12.61小时，占一天时间的50%以上，在家中的时间超过80%。因此，我们在数据收集中选择了家中的四种不同的坐姿和不同的躺姿（见图5）。我们在这些姿势中对两个受试者的数据进行了约180分钟的收集。

##### 2 网络训练

为了训练提出的网络，我们将窗口大小设置为10秒，其中包含200帧作为输入数据。我们网络中的不确定性组件被初始化为零，而其余部分被随机初始化。网络采用PyTorch实现，应用带有固定学习率1e-5的ADAM优化器。网络在NVIDIA Titan X GPU上进行训练，使用小批量大小为512和丢失率概率为0.2。

#### V. EVALUATION 结果

在本节中，我们系统地评估mBeats。我们从实验设置的介绍开始，然后将我们的DNN预测器与心率估计的已建立基线进行比较。随后对不确定性估计进行检验，然后研究服务模块的影响。

##### 1 设置

###### A 对比方法

在本节中，将使用三种常见的信号处理方法作为基线方法：快速傅里叶变换（FFT）[26]，峰值计数（PK）[37]和自相关（XCORR）[38]。


###### B 实验前准备 Pre-processing

预处理：在获取原始数据流之后，由于系统校准，丢弃前40秒和最后20秒的帧。此外，还丢弃了在毫米波服务模块动态搜索最佳方向时收集的数据帧。我们采用大小为200、步幅为1的滑动窗口来取样。

###### C 评估方法

与[5]类似，我们在整个实验中使用准确性作为评估指标。值得一提的是，为了临床有效性[39]，可用的心率估计器应至少具有90%的准确性。为了训练我们的DNN预测器，我们将数据分成训练集、验证集和测试集。根据实验需求，这三组数据集的准备方式不同，将在随后的章节中详细说明。

##### 2 性能比较

为了验证我们的DNN预测器的心率估计准确性和稳健性，进行了三个实验，包括（i）对所有姿势的整体评估，（ii）姿势交叉评估，和（iii）受试者交叉评估。图6总结了整体比较结果。

###### 1 整体比较

在这个实验中，所有的数据流被均匀地分成了5个连续的片段，其中片段1、3、5用于训练，而片段4和片段2分别用于验证和测试。如表I所示，尽管竞争方法在胸部感知场景中已被证明是有效的，但当涉及到下肢感知时，它们很难准确地估计心率。由于从小腿感知到的微小皮肤位移非常微弱，竞争方法无法可靠地估计心率，并且在不同的姿势下保持一致的准确性。例如，作为表现最佳的基线方法，XCORR在姿势5上的准确率达到了94.10%，但其在姿势3上的准确率仅为48.27%。XCORR的低鲁棒性使其不适用于真实的家庭场景，其中各种各样的日常姿势很常见。当考虑到90%的准确率标准来衡量方法的有效性时，我们提出的DNN估计器是唯一在所有8种姿势下都满足这一标准的方法，在整体上有5.26%的安全余量。相比之下，FFT方法只在一个姿势下达到了这个准确度，而PK在所有姿势下都未能达到这个标准。

###### 2 跨姿势评估

接下来，我们评估我们的DNN估计器在不同姿势下的泛化能力。为此，我们将数据集分成8个部分，对应不同的姿势。姿势1、3、5、7的数据用作训练数据，姿势4和8用于模型验证，姿势2和6用作测试数据。如表II所示，我们的DNN方法对不同用户姿势具有很强的泛化能力，在来自姿势2和6的未见数据上分别达到了96.08%和93.94%的准确率。从整体测试到跨姿势测试的准确率下降仅为0.25%，表明了在实际部署中的可行性。值得注意的是，FFT、PK和XCORR是基于信号处理的方法，原则上对跨姿势不敏感。然而，它们的准确率仍然低于我们的DNN估计器。

###### 3 跨受试者评估

我们进一步在跨受试者测试上评估我们的方法，即在来自训练集之外的新受试者的数据上测试DNN估计器。尽管不同的人有不同的心跳模式[40]，[41]，但如表III所示，我们的DNN估计器仍在两个不同受试者的测试数据上分别达到了93.85%和93.03%的准确率。这种高准确性明显优于竞争方法约7%。这种泛化能力对于实际部署至关重要，因为在向客户交付之前可以使用众包方法来训练DNN预测器。


##### 3 不确定性评估

如第III-C.3节所述，我们的方法具有显著优势，即能够在心率预测之外提供置信度估计。这对于在医疗监测中避免误报非常重要，因为高不确定性的预测可以被过滤掉。此外，它还作为一个线索，有助于在未充分训练的情况下通过学习更多样本来改进网络，这对于终身学习至关重要。图7展示了在跨姿势实验中的不确定性估计示例。我们可以看到不确定性（即变化量）与预测误差之间存在正相关关系。具体来说，当误差低于3 BPM时，我们观察到变化很小（< 0.5），而在峰值误差时，变化可以达到1.2。

##### 4 impact of the mmWave Servoing Module

在先前的实验中，我们使用了在最佳观测视角下收集的心跳波形。在最后一个实验中，我们调查了将mmWave服务模块纳入系统循环的重要性，该模块负责搜索最佳观测视角。我们两次收集了相同用户姿势和机器人位置的3分钟数据流。唯一的区别是是否使用了伺服模块。请注意，mmWave雷达的初始测量视图手动设置为75度，偏离最佳角度。为了进行公平比较，我们将此初始化设置固定为所有基准测试。从表IV的实验结果中，我们可以看到，打开mmWave伺服模块后，PTA指标从平均2.11提高到平均3.27。这进一步提高了所有方法的整体测量精度。这与我们的假设一致，即PTA对测量精度至关重要，并因此证明了在测量之前利用mmWave服务模块进行方向优化的必要性。此外，我们的方法再次显示出优越的性能。即使禁用了mmWave伺服模块，我们的方法仍然是唯一一个产生满意准确率超过90%的方法，证明了在未知情况下的强大泛化能力。


#### 复现

##### 1 readme
![[Pasted image 20240416161713.png]]

####  论文位置


![[Heart_Rate_Sensing_with_a_Robot_Mounted_mmWave_Radar.pdf]]